# –ú—ñ–≥—Ä–∞—Ü—ñ—è –∑ 0.x (v1) to v2

–ü–æ—á–∏–Ω–∞—é—á–∏ –∑ –≤–µ—Ä—Å—ñ—ó `2.0.0-rc.4`, pinia –ø—ñ–¥—Ç—Ä–∏–º—É—î —è–∫ Vue 2, —Ç–∞–∫ —ñ Vue 3! –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –≤—Å—ñ –Ω–æ–≤—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –±—É–¥—É—Ç—å –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω—ñ –¥–æ —Ü—ñ—î—ó –≤–µ—Ä—Å—ñ—ó 2, —Ç–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ —ñ Vue 2, —ñ Vue 3 –∑–º–æ–∂—É—Ç—å —Å–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏—Å—è —Ü–∏–º. –Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ Vue 3, —Ü–µ –Ω—ñ—á–æ–≥–æ –Ω–µ –∑–º—ñ–Ω–∏—Ç—å –¥–ª—è –≤–∞—Å, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–∏ –≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ rc, —ñ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ [CHANGELOG](https://github.com/vuejs/pinia/blob/v2/packages/pinia/CHANGELOG.md) –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ—è—Å–Ω–µ–Ω–Ω—è –≤—Å—ñ—Ö –∑–º—ñ–Ω. –í —ñ–Ω—à–æ–º—É –≤–∏–ø–∞–¥–∫—É, **—Ü–µ–π –ø–æ—Å—ñ–±–Ω–∏–∫ –¥–ª—è –≤–∞—Å**!

## –ó–∞—Å—Ç–∞—Ä—ñ–ª–µ

–î–∞–≤–∞–π—Ç–µ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –≤—Å—ñ –∑–º—ñ–Ω–∏, —è–∫—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –¥–æ –∫–æ–¥—É. –ü–æ-–ø–µ—Ä—à–µ, –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∏ –≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –æ—Å—Ç–∞–Ω–Ω—é –≤–µ—Ä—Å—ñ—é 0.x, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –±—É–¥—å-—è–∫—ñ –∑–∞—Å—Ç–∞—Ä—ñ–ª—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:

```shell
npm i 'pinia@^0.x.x'
# –∞–±–æ –∑ yarn
yarn add 'pinia@^0.x.x'
```

–Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ ESLint, –ø–æ–¥—É–º–∞–π—Ç–µ –ø—Ä–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è [—Ü—å–æ–≥–æ –ø–ª–∞–≥—ñ–Ω–∞](https://github.com/gund/eslint-plugin-deprecation), —â–æ–± –∑–Ω–∞–π—Ç–∏ –≤—Å—ñ –∑–∞—Å—Ç–∞—Ä—ñ–ª—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è. –í —ñ–Ω—à–æ–º—É –≤–∏–ø–∞–¥–∫—É –≤–∏ –∑–º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ —ó—Ö —Ç–∞–∫, —è–∫ –≤–æ–Ω–∏ –≤–∏–≥–ª—è–¥–∞—é—Ç—å –ø–µ—Ä–µ—Ö—Ä–µ—â–µ–Ω–∏–º–∏. –¶–µ API, —è–∫—ñ –±—É–ª–∏ –∑–∞—Å—Ç–∞—Ä—ñ–ª–∏–º–∏ —Ç–∞ –±—É–ª–∏ –≤–∏–¥–∞–ª–µ–Ω—ñ:

- `createStore()` —Å—Ç–∞–ª–æ `defineStore()`
- –£ –ø—ñ–¥–ø–∏—Å–∫–∞—Ö `storeName` —Å—Ç–∞–ª–æ `storeId`
- `PiniaPlugin` –±—É–ª–æ –ø–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω–æ –Ω–∞ `PiniaVuePlugin` (–ø–ª–∞–≥—ñ–Ω Pinia –¥–ª—è Vue 2)
- `$subscribe()` –±—ñ–ª—å—à–µ –Ω–µ –ø—Ä–∏–π–º–∞—î _boolean_ —è–∫ –¥—Ä—É–≥–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä, –Ω–∞—Ç–æ–º—ñ—Å—Ç—å –ø–µ—Ä–µ–¥–∞–π—Ç–µ –æ–±'—î–∫—Ç —ñ–∑ `detached: true`.
- –ü–ª–∞–≥—ñ–Ω–∏ Pinia –±—ñ–ª—å—à–µ –Ω–µ –æ—Ç—Ä–∏–º—É—é—Ç—å –Ω–∞–ø—Ä—è–º—É `id` —Å—Ö–æ–≤–∏—â–∞. –ù–∞—Ç–æ–º—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `store.$id`.

## –ù–µ—Å—É–º—ñ—Å–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è

–ü—ñ—Å–ª—è —ó—Ö –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤–∏ –º–æ–∂–µ—Ç–µ –æ–Ω–æ–≤–∏—Ç–∏ –¥–æ v2 –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:

```shell
npm i 'pinia@^2.x.x'
# –∞–±–æ –∑ yarn
yarn add 'pinia@^2.x.x'
```

–Ü –ø–æ—á–Ω—ñ—Ç—å –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Å–≤—ñ–π –∫–æ–¥.

### –ó–∞–≥–∞–ª—å–Ω–∏–π —Ç–∏–ø —Å—Ö–æ–≤–∏—â–∞

–î–æ–¥–∞–Ω–æ –≤ [2.0.0-rc.0](https://github.com/vuejs/pinia/blob/v2/packages/pinia/CHANGELOG.md#200-rc0-2021-07-28)

–ó–∞–º—ñ–Ω—ñ—Ç—å –±—É–¥—å-—è–∫–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–∏–ø—É `GenericStore` –Ω–∞ `StoreGeneric`. –¶–µ –Ω–æ–≤–∏–π –∑–∞–≥–∞–ª—å–Ω–∏–π —Ç–∏–ø —Å—Ö–æ–≤–∏—â–∞, —è–∫–∏–π –ø–æ–≤–∏–Ω–µ–Ω –ø—Ä–∏–π–º–∞—Ç–∏ –±—É–¥—å-—è–∫–∏–π —Ç–∏–ø —Å—Ö–æ–≤–∏—â–∞. –Ø–∫—â–æ –≤–∏ –ø–∏—Å–∞–ª–∏ —Ñ—É–Ω–∫—Ü—ñ—ó, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ç–∏–ø `Store`, –Ω–µ –≤–∫–∞–∑—É—é—á–∏ –π–æ–≥–æ –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ —Ç–∏–ø—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `Store<Id, State, Getters, Actions>`), –≤–∏ —Ç–∞–∫–æ–∂ –º–∞—î—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `StoreGeneric` –æ—Å–∫—ñ–ª—å–∫–∏ —Ç–∏–ø `Store` –±–µ–∑ –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ —Å—Ç–≤–æ—Ä—é—î –ø–æ—Ä–æ–∂–Ω—î —Å—Ö–æ–≤–∏—â–µ —Ç–∏–ø—É.

```ts
function takeAnyStore(store: Store) {} // [!code --]
function takeAnyStore(store: StoreGeneric) {} // [!code ++]

function takeAnyStore(store: GenericStore) {} // [!code --]
function takeAnyStore(store: StoreGeneric) {} // [!code ++]
```

## `DefineStoreOptions` –¥–ª—è –ø–ª–∞–≥—ñ–Ω—ñ–≤

–Ø–∫—â–æ –≤–∏ –ø–∏—Å–∞–ª–∏ –ø–ª–∞–≥—ñ–Ω–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ TypeScript, —ñ —Ä–æ–∑—à–∏—Ä—é–≤–∞–ª–∏ —Ç–∏–ø `DefineStoreOptions`, —â–æ–± –¥–æ–¥–∞—Ç–∏ –≤–ª–∞—Å–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ, –≤–∞–º —Å–ª—ñ–¥ –ø–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏ –π–æ–≥–æ –Ω–∞ `DefineStoreOptionsBase`. –¶–µ–π —Ç–∏–ø –±—É–¥–µ –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ —è–∫ –¥–æ —Å—Ö–æ–≤–∏—â setup, —Ç–∞–∫ —ñ –¥–æ –æ–ø—Ü—ñ–π–Ω–∏—Ö —Å—Ö–æ–≤–∏—â.

```ts
declare module 'pinia' {
  export interface DefineStoreOptions<S, Store> { // [!code --]
  export interface DefineStoreOptionsBase<S, Store> { // [!code ++]
    debounce?: {
      [k in keyof StoreActions<Store>]?: number
    }
  }
}
```

## `PiniaStorePlugin` –±—É–ª–æ –ø–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω–æ

–¢–∏–ø `PiniaStorePlugin` –±—É–ª–æ –ø–µ—Ä–µ–π–º–µ–Ω–æ–≤–∞–Ω–æ –Ω–∞ `PiniaPlugin`.

```ts
import { PiniaStorePlugin } from 'pinia' // [!code --]
import { PiniaPlugin } from 'pinia' // [!code ++]

const piniaPlugin: PiniaStorePlugin = () => { // [!code --]
const piniaPlugin: PiniaPlugin = () => { // [!code ++]
  // ...
}
```

**–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É, —â–æ —Ü—é –∑–º—ñ–Ω—É –º–æ–∂–Ω–∞ –≤–Ω–µ—Å—Ç–∏ –ª–∏—à–µ –ø—ñ—Å–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–æ –æ—Å—Ç–∞–Ω–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó Pinia –±–µ–∑ –∑–∞—Å—Ç–∞—Ä—ñ–ª–æ—Å—Ç–µ–π**.

## –í–µ—Ä—Å—ñ—è `@vue/composition-api`

–û—Å–∫—ñ–ª—å–∫–∏ pinia —Ç–µ–ø–µ—Ä –ø–æ–∫–ª–∞–¥–∞—î—Ç—å—Å—è –Ω–∞ `effectScope()`, –≤–∏ –ø–æ–≤–∏–Ω–Ω—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–∏–Ω–∞–π–º–Ω—ñ –≤–µ—Ä—Å—ñ—é `1.1.0` `@vue/composition-api`:

```shell
npm i @vue/composition-api@latest
# –∞–±–æ –∑ yarn
yarn add @vue/composition-api@latest
```

## –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ webpack 4

–Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ webpack 4 (Vue CLI –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î webpack 4), –≤–∏ –º–æ–∂–µ—Ç–µ –∑—ñ—Ç–∫–Ω—É—Ç–∏—Å—è –∑ —Ç–∞–∫–æ—é –ø–æ–º–∏–ª–∫–æ—é:

```
ERROR  –ù–µ –≤–¥–∞–ª–æ—Å—è —Å–∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ –∑ 18 –ø–æ–º–∏–ª–∫–∞–º–∏

 –ø–æ–º–∏–ª–∫–∞ –≤ ./node_modules/pinia/dist/pinia.mjs

–ù–µ –≤–¥–∞—î—Ç—å—Å—è —ñ–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —ñ–º–µ–Ω–æ–≤–∞–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç 'computed' –∑ –Ω–µ EcmaScript –º–æ–¥—É–ª—è (–¥–æ—Å—Ç—É–ø–Ω–∏–π –ª–∏—à–µ –µ–∫—Å–ø–æ—Ä—Ç –∑–∞ —É–º–æ–≤—á–∞–Ω–Ω—è–º)
```

–¶–µ –ø–æ–≤'—è–∑–∞–Ω–æ –∑ –º–æ–¥–µ—Ä–Ω—ñ–∑–∞—Ü—ñ—î—é —Ñ–∞–π–ª—ñ–≤ dist –¥–ª—è –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –≤–ª–∞—Å–Ω–∏—Ö –º–æ–¥—É–ª—ñ–≤ —É Node.js. –§–∞–π–ª–∏ —Ç–µ–ø–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è `.mjs` —ñ `.cjs`, —â–æ–± Node –º–∞–≤ –ø–µ—Ä–µ–≤–∞–≥–∏ –≤—ñ–¥ —Ü—å–æ–≥–æ. –©–æ–± –≤–∏—Ä—ñ—à–∏—Ç–∏ —Ü—é –ø—Ä–æ–±–ª–µ–º—É, —É –≤–∞—Å —î —Ç–∞–∫—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:

- –Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ Vue CLI 4.x, –æ–Ω–æ–≤—ñ—Ç—å —Å–≤–æ—ó –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ. –¶–µ –ø–æ–≤–∏–Ω–Ω–æ –≤–∫–ª—é—á–∞—Ç–∏ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –Ω–∏–∂—á–µ.
  - –Ø–∫—â–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–µ–º–æ–∂–ª–∏–≤–µ –¥–ª—è –≤–∞—Å, –¥–æ–¥–∞–π—Ç–µ —Ü–µ –¥–æ —Å–≤–æ–≥–æ `vue.config.js`:

    ```js
    // vue.config.js
    module.exports = {
      configureWebpack: {
        module: {
          rules: [
            {
              test: /\.mjs$/,
              include: /node_modules/,
              type: 'javascript/auto',
            },
          ],
        },
      },
    }
    ```

- –Ø–∫—â–æ –≤–∏ –≤—Ä—É—á–Ω—É –æ–±—Ä–æ–±–ª—è—î—Ç–µ webpack, –≤–∞–º –¥–æ–≤–µ–¥–µ—Ç—å—Å—è –ø–æ–≤—ñ–¥–æ–º–∏—Ç–∏ –π–æ–º—É, —è–∫ –æ–±—Ä–æ–±–ª—è—Ç–∏ —Ñ–∞–π–ª–∏ `.mjs`:

  ```js
  // webpack.config.js
  module.exports = {
    module: {
      rules: [
        {
          test: /\.mjs$/,
          include: /node_modules/,
          type: 'javascript/auto',
        },
      ],
    },
  }
  ```

## –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞

Pinia v2 –±—ñ–ª—å—à–µ –Ω–µ –∑–∞—Ö–æ–ø–ª—é—î Vue Devtools v5, –¥–ª—è —Ü—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω Vue Devtools v6. –ó–Ω–∞–π–¥—ñ—Ç—å –ø–æ—Å–∏–ª–∞–Ω–Ω—è –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤ [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó Vue Devtools](https://devtools.vuejs.org/guide/installation.html#chrome) –¥–ª—è **–±–µ—Ç–∞-–∫–∞–Ω–∞–ª—É** —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è.

## Nuxt

–Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ Nuxt, —É pinia —Ç–µ–ø–µ—Ä —î —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π –ø–∞–∫–µ—Ç Nuxt üéâ. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –π–æ–≥–æ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é:

```bash
npm i @pinia/nuxt
# –∞–±–æ –∑ yarn
yarn add @pinia/nuxt
```

–¢–∞–∫–æ–∂ –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ **–æ–Ω–æ–≤–∏–ª–∏ —Å–≤—ñ–π –ø–∞–∫–µ—Ç `@nuxtjs/composition-api`**.

–ü–æ—Ç—ñ–º –∞–¥–∞–ø—Ç—É–π—Ç–µ –≤–∞—à `nuxt.config.js` —Ç–∞ `tsconfig.json`, —è–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ TypeScript:

```js
// nuxt.config.js
module.exports {
  buildModules: [
    '@nuxtjs/composition-api/module',
    'pinia/nuxt', // [!code --]
    '@pinia/nuxt', // [!code ++]
  ],
}
```

```json
// tsconfig.json
{
  "types": [
    // ...
    "pinia/nuxt/types" // [!code --]
    "@pinia/nuxt" // [!code ++]
  ]
}
```

–¢–∞–∫–æ–∂ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ [—Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π —Ä–æ–∑–¥—ñ–ª Nuxt](../ssr/nuxt.md).
