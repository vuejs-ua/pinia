# Nuxt.js

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Pinia –∑ [Nuxt](https://nuxt.com/) –ª–µ–≥—à–µ, –æ—Å–∫—ñ–ª—å–∫–∏ Nuxt –ø—ñ–∫–ª—É—î—Ç—å—Å—è –ø—Ä–æ –±–∞–≥–∞—Ç–æ —Ä–µ—á–µ–π, –∫–æ–ª–∏ –π–¥–µ—Ç—å—Å—è –ø—Ä–æ _–≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ —Å–µ—Ä–≤–µ—Ä–∞_. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, **–≤–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—ñ–∫–ª—É–≤–∞—Ç–∏—Å—è –Ω—ñ –ø—Ä–æ —Å–µ—Ä—ñ–∞–ª—ñ–∑–∞—Ü—ñ—é, –Ω—ñ –ø—Ä–æ –∞—Ç–∞–∫–∏ XSS**. Pinia –ø—ñ–¥—Ç—Ä–∏–º—É—î Nuxt Bridge —ñ Nuxt 3. –ü—Ä–æ –ø—ñ–¥—Ç—Ä–∏–º–∫—É Nuxt 2 [–¥–∏–≤—ñ—Ç—å—Å—è –Ω–∏–∂—á–µ](#nuxt-2-without-bridge).

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

```bash
yarn add pinia @pinia/nuxt
# –∞–±–æ –∑ npm
npm install pinia @pinia/nuxt
```

:::tip
–Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ npm, –≤–∏ –º–æ–∂–µ—Ç–µ –∑—ñ—Ç–∫–Ω—É—Ç–∏—Å—è –∑ –ø–æ–º–∏–ª–∫–æ—é _ERESOLVE –Ω–µ–º–æ–∂–ª–∏–≤–æ —Ä–æ–∑–∫–ª–∞—Å—Ç–∏ –¥–µ—Ä–µ–≤–æ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π_. –£ —Ç–∞–∫–æ–º—É –≤–∏–ø–∞–¥–∫—É –¥–æ–¥–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω–µ –¥–æ —Å–≤–æ–≥–æ `package.json`:

```js
"overrides": {
  "vue": "latest"
}
```

:::

–ú–∏ –Ω–∞–¥–∞—î–º–æ _module_ , —â–æ–± –æ–±—Ä–æ–±–ª—è—Ç–∏ –≤—Å–µ –¥–ª—è –≤–∞—Å, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ª–∏—à–µ –¥–æ–¥–∞—Ç–∏ –π–æ–≥–æ –¥–æ `modules` —É –≤–∞—à–æ–º—É —Ñ–∞–π–ª—ñ `nuxt.config.js`:

```js
// nuxt.config.js
export default defineNuxtConfig({
  // ... —ñ–Ω—à—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
  modules: [
    // ...
    '@pinia/nuxt',
  ],
})
```

–Ü –≤—Å–µ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Å–≤–æ—î —Å—Ö–æ–≤–∏—â–µ —è–∫ –∑–∞–≤–∂–¥–∏!

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å—Ö–æ–≤–∏—â–∞ –∑–∞ –º–µ–∂–∞–º–∏ `setup()`

–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å—Ö–æ–≤–∏—â–µ –∑–∞ –º–µ–∂–∞–º–∏ `setup()`, –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç–∏ –æ–±'—î–∫—Ç `pinia` –≤ `useStore()`. –ú–∏ –¥–æ–¥–∞–ª–∏ –π–æ–≥–æ –¥–æ [–∫–æ–Ω—Ç–µ–∫—Å—Ç—É](https://nuxtjs.org/docs/2.x/internals-glossary/context) —â–æ–± –≤–∏ –º–∞–ª–∏ –¥–æ—Å—Ç—É–ø –¥–æ –Ω—å–æ–≥–æ –≤ `asyncData()` —ñ `fetch()`:

```js
import { useStore } from '~/stores/myStore'

export default {
  asyncData({ $pinia }) {
    const store = useStore($pinia)
  },
}
```

–Ø–∫ —ñ —É –≤–∏–ø–∞–¥–∫—É –∑ `onServerPrefetch()`, –≤–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–æ–±–∏—Ç–∏ –Ω—ñ—á–æ–≥–æ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ–≥–æ, —è–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –¥—ñ—é —Å—Ö–æ–≤–∏—â–∞ –≤ `asyncData()`:

```vue
<script setup>
const store = useStore()
const { data } = await useAsyncData('user', () => store.fetchUser())
</script>
```

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ —ñ–º–ø–æ—Ä—Ç—É–≤–∞–Ω–Ω—è

–ó–∞ —É–º–æ–≤—á–∞–Ω–Ω—è–º `@pinia/nuxt` –Ω–∞–¥–∞—î –æ–¥–∏–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —ñ–º–ø–æ—Ä—Ç: `usePinia()`, —è–∫–∏–π —Å—Ö–æ–∂–∏–π –Ω–∞ `getActivePinia()`, –∞–ª–µ –∫—Ä–∞—â–µ –ø—Ä–∞—Ü—é—î –∑ Nuxt. –í–∏ –º–æ–∂–µ—Ç–µ –¥–æ–¥–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π —ñ–º–ø–æ—Ä—Ç, —â–æ–± –ø–æ–ª–µ–≥—à–∏—Ç–∏ –≤–∞—à–µ –∂–∏—Ç—Ç—è:

```js
// nuxt.config.js
export default defineNuxtConfig({
  // ... —ñ–Ω—à—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
  modules: ['@pinia/nuxt'],
  pinia: {
    autoImports: [
      // –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —ñ–º–ø–æ—Ä—Ç—É—î `defineStore`
      'defineStore', // import { defineStore } from 'pinia'
      ['defineStore', 'definePiniaStore'], // import { defineStore as definePiniaStore } from 'pinia'
    ],
  },
})
```

## Nuxt 2 –±–µ–∑ –º–æ—Å—Ç–∞

Pinia –ø—ñ–¥—Ç—Ä–∏–º—É—î Nuxt 2 –¥–æ `@pinia/nuxt` v0.2.1. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ —Ç–∞–∫–æ–∂ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ [`@nuxtjs/composition-api`](https://composition-api.nuxtjs.org/) —Ä–∞–∑–æ–º —ñ–∑ `pinia`:

```bash
yarn add pinia @pinia/nuxt@0.2.1 @nuxtjs/composition-api
# –∞–±–æ –∑ npm
npm install pinia @pinia/nuxt@0.2.1 @nuxtjs/composition-api
```

–ú–∏ –Ω–∞–¥–∞—î–º–æ _module_, —â–æ–± –æ–±—Ä–æ–±–ª—è—Ç–∏ –≤—Å–µ –¥–ª—è –≤–∞—Å, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ª–∏—à–µ –¥–æ–¥–∞—Ç–∏ –π–æ–≥–æ –¥–æ `buildModules` —É –≤–∞—à–æ–º—É —Ñ–∞–π–ª—ñ `nuxt.config.js`:

```js
// nuxt.config.js
export default {
  // ... —ñ–Ω—à—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
  buildModules: [
    // –¢—ñ–ª—å–∫–∏ –¥–ª—è Nuxt 2:
    // https://composition-api.nuxtjs.org/getting-started/setup#quick-start
    '@nuxtjs/composition-api/module',
    '@pinia/nuxt',
  ],
}
```

### TypeScript

–Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ Nuxt 2 (`@pinia/nuxt` < 0.3.0) –∑ TypeScript –∞–±–æ –º–∞—î—Ç–µ `jsconfig.json`, –≤–∞–º —Ç—Ä–µ–±–∞ —Ç–∞–∫–æ–∂ –¥–æ–¥–∞—Ç–∏ —Ç–∏–ø–∏ –¥–ª—è `context.pinia`:

```json
{
  "types": [
    // ...
    "@pinia/nuxt"
  ]
}
```

–¶–µ —Ç–∞–∫–æ–∂ –∑–∞–±–µ–∑–ø–µ—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –¥–ª—è –≤–∞—Å üòâ .

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Pinia —Ä–∞–∑–æ–º –∑ Vuex

–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è **—É–Ω–∏–∫–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Pinia —Ç–∞ Vuex –≤–æ–¥–Ω–æ—á–∞—Å**, –∞–ª–µ —è–∫—â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–±–∏–¥–≤–∞, –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å–∫–∞–∑–∞—Ç–∏ pinia –Ω–µ –≤–∏–º–∏–∫–∞—Ç–∏ –π–æ–≥–æ:

```js
// nuxt.config.js
export default {
  buildModules: [
    '@nuxtjs/composition-api/module',
    ['@pinia/nuxt', { disableVuex: false }],
  ],
  // ... —ñ–Ω—à—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
}
```
